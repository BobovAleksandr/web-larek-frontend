# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

<template id="card-preview">
		<div class="card card_full">
			<img class="card__image" src="<%=require('../images/Subtract.svg')%>" alt="" />
			<div class="card__column">
				<span class="card__category card__category_other">другое</span>
				<h2 class="card__title">Бэкенд-антистресс</h2>
				<p class="card__text">Если планируете решать задачи в тренажёре, берите два.</p>
				<div class="card__row">
					<button class="button card__button">В корзину</button>
					<span class="card__price">1000 синапсов</span>
				</div>
			</div>
		</div>
	</template>

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Базовый код

## Слои:
1. Модель данных (хранение и изменение данных)
2. Отображение данных
3. Презентер для соединения модели с отображением

# Слой данных

## Типы

### Тип Payment
Тип определяет варианты оплаты товара

### Тип Category
Тип определяет список категорий товаров

## Классы

### Класс Product
Класс отвечает за хранение информации о товаре. 
- `id: string;` - id товара
- `title: string;` - Название товара
- `category: Category;` - Категория товара
- `description: string;` - Описание товара
- `image: string;` - Ссылка на изображение товара
- `price: number;` - Стоимость товара

### Класс Basket
Класс отвечает за хранение товара в корзине. `constructor() { this.products = [] }`. Коструктор класса создаёт пустой массив товаров.
- `products: IProduct[];` - массив товаров, находящихся в корзине. 
- `add(newProduct: IProduct)` - метод добавляет товар в массив `products`, принимает объект товара.
- `remove(id: string)` - метод удаляет карточку из массива `products`. Принимает id карточки.
- `clear()` - метод очищает корзину, удаляя все элементы из массива `products`
- `createOrder()` - метод возвращает массив товаров в корзине для продолженния оформляния заказа.

### Класс Order
Класс отвечает за хранение информации о текущем заказе. Получает информацию от пользователя. Конструктор класс принимает объект заказа, содержащий следующие параметры:
- `products: IProduct[];` - Массив товаров в корзине
- `paymentMethod: Payment;` - Способ оплаты
- `shippingAdress: string;` - Адрес доставки
- `email: string;` - Email
- `phone: string;` - Номер телефона

# Слой отображения
Слой отображения отвечает за отображение и изменение элементов на странице

### Класс CardsContainer
Класс реализует контейнер для элементов карточек на главной странице. В конструктор принимает элемент карточки товара.

Методы:
- Сеттер `container` - принимает массив карточек с сервера.

### Класс Basket 
Класс реализует элемент корзины на главной странице, отображая текущее количество товаров в корзине. 

Методы:
- `render(): void` - обновляет количество товаров на иконке корзины.

### Класс Card
Реализует элемент карточки. Конструктор класса принимает DOM-элемент темплейта. В классе устанавливается слушатель на аму карточку для открытия модального окна с информацией о карточке. Так же конструктор принимает экземпляр `EventEmitter` для инициации событий.

Методы:
- `setData(Card: IProduct): void` - заполняет атрибуты элементов карточки данными
- Геттер `id` - возвращает id карточки
- `deleteCard(): void` - удаляет карточку (в модальном окне корзины)
- `render(): HTMLElement` - возвращает заполненную карточку для рендера на странице.


### Класс Modal
Реализует модальное окно. Содержит методы `open` и `close` для управления отображением модального окна. Устанавливает слушатели на клавиатуру для закрытия окна по нажатию Esc, для закрытия по нажатию на кнопку-крестик, для закрытия по нажатию на овверлей. `constructor() { selector: string, events: IEvents }`. Конструктор принимает селектор по которому будет идентифицировано модальное окно и экземпляр класса `EventEmitter` для возможности инициации событий.

Поля класса:
- `modal: HTMLElement` - элемент модального окна
- `events: IEvents` - брокер событий

### Класс ModalWithForm
Расширяет класс `modal`. Реализует модальное окно с формой для ввода информации пользователем.

Поля класса:
- `formElement` - Элемент формы
- `submitButton` - Кнопка сабмита формы

Методы класса:
- `open(handleSubmit: Fucntion)` - расширяет родительский метод `open`, принимая обработчик нажатия кнопки сабмита формы.
- `close(): void` - расширяет родительский метод `close`, очищает инпуты формы модального окна.


# Слой презентера
Код взаимодействия предсталвения и данных находится в файле `index.ts`. \
Взаимодействие осуществляется за счет событий, генерируемых брокером и обработчиками, описанными в `index.ts`
В `index.ts` создаются экземлпяры необходимых классов и настраивается обработка событий.


События, генерируемые системой:
- `cards:changed` - изменение массива карточек
- `card:open` - откртие карточки товара в модальном окне

События, генерируемые пользователем при взаимодействии с интерфейсом:
- `card:addToBasket` - добавление карточки в корзину
- `card:removeFromBasket` - добавление карточки в корзину
- `modal:open` - открытие модального окна
- `modal:close` - закрытие модального окна
- `card:addToBasket` - событие добавления товара в корзину
- `basket:submit` - сабмит модального окна корзины
- `basket:changed` - изменение корзины
- `payModal:input` - изменение данных в форме модального окна со способом оплаты и адресом
- `payModal:submit` - сабмит модального окна со способом оплаты и адресом
- `contactsModal:input` - изменение данных в форме модального окна с email и телефоном
- `contactsModal:submit` - сабмит модального окна с email и телефоном




